version: 1

env_profiles:
  codex-reviewer:
    CODEX_SANDBOX: read-only
    CODEX_MODE: full-auto
  claude-reviewer: {}
  local-default: {}

defaults:
  input_schema_ref: schemas/poc/mailbox-envelope.v1.schema.json
  output_schema_ref: schemas/poc/review-result.v1.schema.json
  spawn_policy: per_task_process
  max_concurrency: 1
  lease_ttl_sec: 180
  retry:
    max_attempts: 2
  timeouts:
    soft_sec: 600
    hard_sec: 900

agents:
  - id: codex
    name: Codex Reviewer
    role: reviewer
    provider: codex
    model: gpt-5-codex
    prompt_file: prompts/reviewer/codex.md
    instruction: Focus on security and architecture quality.
    env_profile: codex-reviewer

  - id: claude
    name: Claude Reviewer
    role: reviewer
    provider: claude
    model: sonnet
    prompt_file: prompts/reviewer/claude.md
    instruction: Focus on performance and operational stability.
    env_profile: claude-reviewer

  - id: codex-architecture-reviewer
    name: Codex Architecture Reviewer
    role: architect
    provider: codex
    model: gpt-5.3-codex
    prompt_file: prompts/reviewer/codex.md
    instruction: Focus on module boundaries and adapter design.
    env_profile: codex-reviewer

  - id: codex-qa-tester
    name: Codex QA Tester
    role: qa_tester
    provider: codex
    model: gpt-5.3-codex
    prompt_file: prompts/reviewer/codex.md
    instruction: Focus on missing tests and regression risk.
    env_profile: codex-reviewer

  - id: aggregator
    name: Review Aggregator
    role: aggregator
    provider: local
    model: deterministic-v1
    prompt_file: prompts/reviewer/aggregator.md
    input_schema_ref: schemas/poc/mailbox-envelope.v1.schema.json
    output_schema_ref: schemas/poc/aggregation-result.v1.schema.json
    spawn_policy: long_running
    max_concurrency: 8
    lease_ttl_sec: 300
    retry:
      max_attempts: 5
    timeouts:
      soft_sec: 30
      hard_sec: 60
    env_profile: local-default

  - id: orchestrator
    name: Control Orchestrator
    role: orchestrator
    provider: local
    model: deterministic-v1
    prompt_file: prompts/reviewer/orchestrator.md
    input_schema_ref: schemas/poc/mailbox-envelope.v1.schema.json
    output_schema_ref: schemas/poc/process-manager-plan.v1.schema.json
    spawn_policy: long_running
    max_concurrency: 4
    lease_ttl_sec: 300
    retry:
      max_attempts: 5
    timeouts:
      soft_sec: 30
      hard_sec: 60
    env_profile: local-default
